
# –ó–∞–Ω—è—Ç–∏–µ 2 ‚Äî –ù–∞—Ä—É—à–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞: –≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

## üéØ –¶–µ–ª–∏ –æ–±—É—á–µ–Ω–∏—è
- –†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —Ä–∞–∑–ª–∏—á–∏—è—Ö –º–µ–∂–¥—É **–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π** –∏ **–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π** —ç—Å–∫–∞–ª–∞—Ü–∏–µ–π –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π.  
- –ü–æ–Ω—è—Ç—å, –∫–∞–∫ –æ—à–∏–±–∫–∏ –≤ –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö –ø—Ä–∞–≤ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.  
- –ù–∞—É—á–∏—Ç—å—Å—è –Ω–∞—Ö–æ–¥–∏—Ç—å –∏ —É—Å—Ç—Ä–∞–Ω—è—Ç—å —Ç–∞–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏.  

---

## üìö –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
**–≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π** ‚Äî —ç—Ç–æ –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è–º, –∫ –∫–æ—Ç–æ—Ä—ã–º –æ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø.  

- **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —ç—Å–∫–∞–ª–∞—Ü–∏—è**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ–≥–æ –∂–µ —É—Ä–æ–≤–Ω—è.  
- **–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —ç—Å–∫–∞–ª–∞—Ü–∏—è**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.  

### –ü–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞–µ—Ç
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.  
- –ü–æ–ª–∞–≥–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´—Å–∫—Ä—ã—Ç—ã–µ¬ª –∫–Ω–æ–ø–∫–∏).  
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è RBAC.  

### –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è
- –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.  
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–¥–º–∏–Ω—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –æ–±—ã—á–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.  
- –ü–æ–ª–Ω—ã–π –∑–∞—Ö–≤–∞—Ç —Å–∏—Å—Ç–µ–º—ã.  

---

## 1) –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –ß—Ç–æ —ç—Ç–æ  
–õ—é–±–æ–π –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å ¬´–∞–¥–º–∏–Ω—Å–∫–∏–π¬ª —ç–Ω–¥–ø–æ–∏–Ω—Ç.  

### –ü—Ä–∏–º–µ—Ä  
```python
# ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏
@login_required
def delete_user(request, user_id):
    User.objects.get(id=user_id).delete()
    return HttpResponse("–£–¥–∞–ª–µ–Ω–æ")
```

‚Üí –î–∞–∂–µ –æ–±—ã—á–Ω—ã–π `user` –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å –∞–∫–∫–∞—É–Ω—Ç—ã.  

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ  
```python
# ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏
@login_required
def delete_user(request, user_id):
    if not request.user.is_staff:
        return HttpResponseForbidden("Admins only")
    ...
```

---

## 2) –ü–æ–ª–∞–≥–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (¬´—Å–∫—Ä—ã—Ç—ã–µ¬ª –∫–Ω–æ–ø–∫–∏)

### –ß—Ç–æ —ç—Ç–æ  
–ê–¥–º–∏–Ω—Å–∫–∞—è –∫–Ω–æ–ø–∫–∞ —Å–∫—Ä—ã—Ç–∞ –≤ UI, –Ω–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç –æ—Ç–∫—Ä—ã—Ç.  

### –ü—Ä–∏–º–µ—Ä —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
```html
<<button id="adminBtn" class="hidden">–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
<<script>
  if (localStorage.getItem("isAdmin") === "true") {
    document.getElementById("adminBtn").classList.remove("hidden");
  }
<</script>
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ª—é–±–æ–π –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å `/delete_user/5/` –Ω–∞–ø—Ä—è–º—É—é.  

---

## 3) –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è RBAC

### –ß—Ç–æ —ç—Ç–æ  
–†–æ–ª—å –¥–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤—Ö–æ–¥—è—â–µ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—É, –∞ –Ω–µ –±–µ—Ä—ë—Ç—Å—è –∏–∑ —Å–µ—Å—Å–∏–∏/–ë–î.  

### –ü—Ä–∏–º–µ—Ä  
```python
# ‚ùå –£—è–∑–≤–∏–º–æ
def promote_user(request, user_id):
    new_role = request.GET.get("role", "user")
    u = User.objects.get(id=user_id)
    u.profile.role = new_role
    u.profile.save()
```

‚Üí –õ—é–±–æ–π –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å `/promote_user/2/?role=admin`.  

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ  
```python
# ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–æ–ª—å –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä–∞
@login_required
def promote_user(request, user_id):
    if request.user.profile.role != "admin":
        return HttpResponseForbidden("Admins only")
    ...
```

---

# ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç Privilege Escalation

* [ ] –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** (RBAC/ABAC).
* [ ] UI-—ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–∂–Ω–æ —Å–∫—Ä—ã–≤–∞—Ç—å –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞, –Ω–æ –Ω–µ –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—É—é –∑–∞—â–∏—Ç—É.
* [ ] –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–≤–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–º –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ä–æ–ª–µ–π.
* [ ] –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏–∑ —Å–µ—Å—Å–∏–∏/—Ç–æ–∫–µ–Ω–∞/–ë–î, –∞ –Ω–µ –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
* [ ] –ß—ë—Ç–∫–∏–π –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ —Ä–æ–ª–µ–π –∏ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.
* [ ] –†–∞–∑–¥–µ–ª—è—Ç—å —É—Ä–æ–≤–Ω–∏ –¥–æ—Å—Ç—É–ø–∞ (user / moderator / admin) –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π.
* [ ] –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏: –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –∞–¥–º–∏–Ω—Å–∫–∏–π —ç–Ω–¥–ø–æ–∏–Ω—Ç, –∞–¥–º–∏–Ω ‚Üí 200, –Ω–µ-–∞–¥–º–∏–Ω ‚Üí 403.

---

–•–æ—á–µ—à—å, —è —É–ø–∞–∫—É—é —ç—Ç–∏ —Ç—Ä–∏ —á–µ–∫-–ª–∏—Å—Ç–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π `.md`-—Ñ–∞–π–ª (–∏–ª–∏ –¥–∞–∂–µ –≤ PDF —Å –∫—Ä–∞—Å–∏–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º), —á—Ç–æ–±—ã –æ–Ω–∏ —à–ª–∏ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫ –∫–æ–Ω—Å–ø–µ–∫—Ç–∞–º?


---



## üõ†Ô∏è –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å (Django Privilege Demo)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cd django_privilege_demo
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
python manage.py migrate
python manage.py seed_demo
python manage.py runserver
```

### –ê–∫–∫–∞—É–Ω—Ç—ã
- `dev / devpass123` ‚Äî –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å  
- `adminroot / adminroot123` ‚Äî —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å  

### –£—è–∑–≤–∏–º—ã–π –º–∞—Ä—à—Ä—É—Ç
- `/vuln/delete_user/<id>/` ‚Äî –ª—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å –∞–∫–∫–∞—É–Ω—Ç—ã.

### –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç
- `/secure/delete_user/<id>/` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

#### –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è
1. –í–æ–π–¥–∏—Ç–µ –ø–æ–¥ `dev`.  
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/vuln/delete_user/1/`.  
3. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å —á—É–∂–∏–µ –∞–∫–∫–∞—É–Ω—Ç—ã.  

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
–î–µ–∫–æ—Ä–∞—Ç–æ—Ä `@user_passes_test(lambda u: u.is_superuser)` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø.  

---

## ‚ùì –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
1. –ß–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —ç—Å–∫–∞–ª–∞—Ü–∏—è –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π?  
2. –ü–æ—á–µ–º—É —Å–∫—Ä—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ?  
3. –ö–∞–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø–æ–º–æ–≥–∞—é—Ç –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç —ç—Å–∫–∞–ª–∞—Ü–∏–∏?  
4. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å RBAC?  

---

## ‚úÖ –ú–µ—Ç–æ–¥—ã –∑–∞—â–∏—Ç—ã
- –ü—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞.  
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RBAC –∏–ª–∏ ABAC.  
- –ü—Ä–∏–Ω—Ü–∏–ø –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π.  
- –†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.  

---

## üîó –ò—Å—Ç–æ—á–Ω–∏–∫–∏
- OWASP Top 10 (2021) ‚Äî [A01: –ù–∞—Ä—É—à–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)  
- CWE-250: [Execution with Unnecessary Privileges](https://cwe.mitre.org/data/definitions/250.html)  
- OWASP Cheat Sheet: [Authorization](https://cheatsheetseries.owasp.org/cheatsheets/Authorization_Cheat_Sheet.html)  
- PortSwigger: [Privilege escalation](https://portswigger.net/web-security/access-control/privilege-escalation)  
